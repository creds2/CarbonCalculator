library(dplyr)
library(jsonlite)
all <- readRDS("data/data_with_grades_v4.Rds")

foo <- names(all)
message(paste(paste0(foo," = mean(",foo,", na.rm = TRUE)"), collapse = ",\n"))

all$country <- "England"

all_la <- all %>%
  group_by(LAD17NM) %>% 
  summarise(gas_percap_2010 = mean(gas_percap_2010, na.rm = TRUE),
            gas_percap_2011 = mean(gas_percap_2011, na.rm = TRUE),
            gas_percap_2012 = mean(gas_percap_2012, na.rm = TRUE),
            gas_percap_2013 = mean(gas_percap_2013, na.rm = TRUE),
            gas_percap_2014 = mean(gas_percap_2014, na.rm = TRUE),
            gas_percap_2015 = mean(gas_percap_2015, na.rm = TRUE),
            gas_percap_2016 = mean(gas_percap_2016, na.rm = TRUE),
            gas_percap_2017 = mean(gas_percap_2017, na.rm = TRUE),
            gas_percap_2018 = mean(gas_percap_2018, na.rm = TRUE),
            elec_percap_2010 = mean(elec_percap_2010, na.rm = TRUE),
            elec_percap_2011 = mean(elec_percap_2011, na.rm = TRUE),
            elec_percap_2012 = mean(elec_percap_2012, na.rm = TRUE),
            elec_percap_2013 = mean(elec_percap_2013, na.rm = TRUE),
            elec_percap_2014 = mean(elec_percap_2014, na.rm = TRUE),
            elec_percap_2015 = mean(elec_percap_2015, na.rm = TRUE),
            elec_percap_2016 = mean(elec_percap_2016, na.rm = TRUE),
            elec_percap_2017 = mean(elec_percap_2017, na.rm = TRUE),
            elec_percap_2018 = mean(elec_percap_2018, na.rm = TRUE),
            other_heat_percap_2011 = mean(other_heat_percap_2011, na.rm = TRUE),
            flights_percap_2018 = mean(flights_percap_2018, na.rm = TRUE),
            nutrition_kgco2e_percap = mean(nutrition_kgco2e_percap, na.rm = TRUE),
            other_shelter_kgco2e_percap = mean(other_shelter_kgco2e_percap, na.rm = TRUE),
            consumables_kgco2e_percap = mean(consumables_kgco2e_percap, na.rm = TRUE),
            recreation_kgco2e_percap = mean(recreation_kgco2e_percap, na.rm = TRUE),
            services_kgco2e_percap = mean(services_kgco2e_percap, na.rm = TRUE),
            commute_noncar_percap = mean(commute_noncar_percap, na.rm = TRUE),
            car_percap_2010 = mean(car_percap_2010, na.rm = TRUE),
            car_percap_2011 = mean(car_percap_2011, na.rm = TRUE),
            car_percap_2012 = mean(car_percap_2012, na.rm = TRUE),
            car_percap_2013 = mean(car_percap_2013, na.rm = TRUE),
            car_percap_2014 = mean(car_percap_2014, na.rm = TRUE),
            car_percap_2015 = mean(car_percap_2015, na.rm = TRUE),
            car_percap_2016 = mean(car_percap_2016, na.rm = TRUE),
            car_percap_2017 = mean(car_percap_2017, na.rm = TRUE),
            car_percap_2018 = mean(car_percap_2018, na.rm = TRUE),
            van_percap_2010 = mean(van_percap_2010, na.rm = TRUE),
            van_percap_2011 = mean(van_percap_2011, na.rm = TRUE),
            van_percap_2012 = mean(van_percap_2012, na.rm = TRUE),
            van_percap_2013 = mean(van_percap_2013, na.rm = TRUE),
            van_percap_2014 = mean(van_percap_2014, na.rm = TRUE),
            van_percap_2015 = mean(van_percap_2015, na.rm = TRUE),
            van_percap_2016 = mean(van_percap_2016, na.rm = TRUE),
            van_percap_2017 = mean(van_percap_2017, na.rm = TRUE),
            van_percap_2018 = mean(van_percap_2018, na.rm = TRUE),
            cars_percap_2010 = mean(cars_percap_2010, na.rm = TRUE),
            cars_percap_2011 = mean(cars_percap_2011, na.rm = TRUE),
            cars_percap_2012 = mean(cars_percap_2012, na.rm = TRUE),
            cars_percap_2013 = mean(cars_percap_2013, na.rm = TRUE),
            cars_percap_2014 = mean(cars_percap_2014, na.rm = TRUE),
            cars_percap_2015 = mean(cars_percap_2015, na.rm = TRUE),
            cars_percap_2016 = mean(cars_percap_2016, na.rm = TRUE),
            cars_percap_2017 = mean(cars_percap_2017, na.rm = TRUE),
            cars_percap_2018 = mean(cars_percap_2018, na.rm = TRUE),
            AvgCO2_cars_2010 = mean(AvgCO2_cars_2010, na.rm = TRUE),
            AvgCO2_cars_2011 = mean(AvgCO2_cars_2011, na.rm = TRUE),
            AvgCO2_cars_2012 = mean(AvgCO2_cars_2012, na.rm = TRUE),
            AvgCO2_cars_2013 = mean(AvgCO2_cars_2013, na.rm = TRUE),
            AvgCO2_cars_2014 = mean(AvgCO2_cars_2014, na.rm = TRUE),
            AvgCO2_cars_2015 = mean(AvgCO2_cars_2015, na.rm = TRUE),
            AvgCO2_cars_2016 = mean(AvgCO2_cars_2016, na.rm = TRUE),
            AvgCO2_cars_2017 = mean(AvgCO2_cars_2017, na.rm = TRUE),
            AvgCO2_cars_2018 = mean(AvgCO2_cars_2018, na.rm = TRUE),
            pP1900 = sum(pP1900, na.rm = TRUE),
            p1900_18 = sum(p1900_18, na.rm = TRUE),
            p1919_29 = sum(p1919_29, na.rm = TRUE),
            p1930_39 = sum(p1930_39, na.rm = TRUE),
            p1945_54 = sum(p1945_54, na.rm = TRUE),
            p1955_64 = sum(p1955_64, na.rm = TRUE),
            p1965_72 = sum(p1965_72, na.rm = TRUE),
            p1973_82 = sum(p1973_82, na.rm = TRUE),
            p1983_92 = sum(p1983_92, na.rm = TRUE),
            p1993_99 = sum(p1993_99, na.rm = TRUE),
            p2000_09 = sum(p2000_09, na.rm = TRUE),
            p2010_15 = sum(p2010_15, na.rm = TRUE),
            pUNKNOWN = sum(pUNKNOWN, na.rm = TRUE),
            Whole_House_Detached = sum(Whole_House_Detached, na.rm = TRUE),
            Whole_House_Semi = sum(Whole_House_Semi, na.rm = TRUE),
            Whole_House_Terraced = sum(Whole_House_Terraced, na.rm = TRUE),
            Flat_PurposeBuilt = sum(Flat_PurposeBuilt, na.rm = TRUE),
            Flat_Converted = sum(Flat_Converted, na.rm = TRUE),
            Flat_Commercial = sum(Flat_Commercial, na.rm = TRUE),
            Caravan = sum(Caravan, na.rm = TRUE),
            epc_total = sum(epc_total, na.rm = TRUE),
            epc_newbuild = sum(epc_newbuild, na.rm = TRUE),
            epc_A = sum(epc_A, na.rm = TRUE),
            epc_B = sum(epc_B, na.rm = TRUE),
            epc_C = sum(epc_C, na.rm = TRUE),
            epc_D = sum(epc_D, na.rm = TRUE),
            epc_E = sum(epc_E, na.rm = TRUE),
            epc_F = sum(epc_F, na.rm = TRUE),
            epc_G = sum(epc_G, na.rm = TRUE),
            epc_score_avg = mean(epc_score_avg, na.rm = TRUE),
            type_house_semi = sum(type_house_semi, na.rm = TRUE),
            type_house_midterrace = sum(type_house_midterrace, na.rm = TRUE),
            type_house_endterrace = sum(type_house_endterrace, na.rm = TRUE),
            type_house_detached = sum(type_house_detached, na.rm = TRUE),
            type_flat = sum(type_flat, na.rm = TRUE),
            type_maisonette = sum(type_maisonette, na.rm = TRUE),
            type_parkhome = sum(type_parkhome, na.rm = TRUE),
            type_other = sum(type_other, na.rm = TRUE),
            type_bungalow = sum(type_bungalow, na.rm = TRUE),
            floor_area_avg = mean(floor_area_avg, na.rm = TRUE),
            low_energy_light = mean(low_energy_light, na.rm = TRUE),
            floor_verygood = sum(floor_verygood, na.rm = TRUE),
            floor_good = sum(floor_good, na.rm = TRUE),
            floor_average = sum(floor_average, na.rm = TRUE),
            floor_poor = sum(floor_poor, na.rm = TRUE),
            floor_verypoor = sum(floor_verypoor, na.rm = TRUE),
            floor_other = sum(floor_other, na.rm = TRUE),
            window_verygood = sum(window_verygood, na.rm = TRUE),
            window_good = sum(window_good, na.rm = TRUE),
            window_average = sum(window_average, na.rm = TRUE),
            window_poor = sum(window_poor, na.rm = TRUE),
            window_verypoor = sum(window_verypoor, na.rm = TRUE),
            window_other = sum(window_other, na.rm = TRUE),
            wall_verygood = sum(wall_verygood, na.rm = TRUE),
            wall_good = sum(wall_good, na.rm = TRUE),
            wall_average = sum(wall_average, na.rm = TRUE),
            wall_poor = sum(wall_poor, na.rm = TRUE),
            wall_verypoor = sum(wall_verypoor, na.rm = TRUE),
            wall_other = sum(wall_other, na.rm = TRUE),
            roof_verygood = sum(roof_verygood, na.rm = TRUE),
            roof_good = sum(roof_good, na.rm = TRUE),
            roof_average = sum(roof_average, na.rm = TRUE),
            roof_poor = sum(roof_poor, na.rm = TRUE),
            roof_verypoor = sum(roof_verypoor, na.rm = TRUE),
            roof_other = sum(roof_other, na.rm = TRUE),
            mainheat_verygood = sum(mainheat_verygood, na.rm = TRUE),
            mainheat_good = sum(mainheat_good, na.rm = TRUE),
            mainheat_average = sum(mainheat_average, na.rm = TRUE),
            mainheat_poor = sum(mainheat_poor, na.rm = TRUE),
            mainheat_verypoor = sum(mainheat_verypoor, na.rm = TRUE),
            mainheat_other = sum(mainheat_other, na.rm = TRUE),
            mainheatcontrol_verygood = sum(mainheatcontrol_verygood, na.rm = TRUE),
            mainheatcontrol_good = sum(mainheatcontrol_good, na.rm = TRUE),
            mainheatcontrol_average = sum(mainheatcontrol_average, na.rm = TRUE),
            mainheatcontrol_poor = sum(mainheatcontrol_poor, na.rm = TRUE),
            mainheatcontrol_verypoor = sum(mainheatcontrol_verypoor, na.rm = TRUE),
            mainheatcontrol_other = sum(mainheatcontrol_other, na.rm = TRUE),
            mainheatdesc_gasboiler = sum(mainheatdesc_gasboiler, na.rm = TRUE),
            mainheatdesc_oilboiler = sum(mainheatdesc_oilboiler, na.rm = TRUE),
            mainheatdesc_storageheater = sum(mainheatdesc_storageheater, na.rm = TRUE),
            mainheatdesc_portableheater = sum(mainheatdesc_portableheater, na.rm = TRUE),
            mainheatdesc_roomheater = sum(mainheatdesc_roomheater, na.rm = TRUE),
            mainheatdesc_heatpump = sum(mainheatdesc_heatpump, na.rm = TRUE),
            mainheatdesc_community = sum(mainheatdesc_community, na.rm = TRUE),
            mainheatdesc_other = sum(mainheatdesc_other, na.rm = TRUE),
            mainfuel_mainsgas = sum(mainfuel_mainsgas, na.rm = TRUE),
            mainfuel_electric = sum(mainfuel_electric, na.rm = TRUE),
            mainfuel_oil = sum(mainfuel_oil, na.rm = TRUE),
            mainfuel_coal = sum(mainfuel_coal, na.rm = TRUE),
            mainfuel_lpg = sum(mainfuel_lpg, na.rm = TRUE),
            mainfuel_biomass = sum(mainfuel_biomass, na.rm = TRUE),
            has_solarpv = sum(has_solarpv, na.rm = TRUE),
            has_solarthermal = sum(has_solarthermal, na.rm = TRUE),
            T2W_WorkAtHome = sum(T2W_WorkAtHome, na.rm = TRUE),
            T2W_Underground = sum(T2W_Underground, na.rm = TRUE),
            T2W_Train = sum(T2W_Train, na.rm = TRUE),
            T2W_Bus = sum(T2W_Bus, na.rm = TRUE),
            T2W_Taxi = sum(T2W_Taxi, na.rm = TRUE),
            T2W_Motorcycle = sum(T2W_Motorcycle, na.rm = TRUE),
            T2W_CarOrVan = sum(T2W_CarOrVan, na.rm = TRUE),
            T2W_Passenger = sum(T2W_Passenger, na.rm = TRUE),
            T2W_Bicycle = sum(T2W_Bicycle, na.rm = TRUE),
            T2W_OnFoot = sum(T2W_OnFoot, na.rm = TRUE),
            T2W_OtherMethod = sum(T2W_OtherMethod, na.rm = TRUE),
            T2W_pct = mean(T2W_pct, na.rm = TRUE),
            km_Underground = sum(km_Underground, na.rm = TRUE),
            km_Train = sum(km_Train, na.rm = TRUE),
            km_Bus = sum(km_Bus, na.rm = TRUE),
            km_Taxi = sum(km_Taxi, na.rm = TRUE),
            km_Motorcycle = sum(km_Motorcycle, na.rm = TRUE),
            km_CarOrVan = sum(km_CarOrVan, na.rm = TRUE),
            km_Passenger = sum(km_Passenger, na.rm = TRUE),
            km_Bicycle = sum(km_Bicycle, na.rm = TRUE),
            km_OnFoot = sum(km_OnFoot, na.rm = TRUE),
            km_OtherMethod = sum(km_OtherMethod, na.rm = TRUE),
            pHeating_None = sum(pHeating_None, na.rm = TRUE),
            pHeating_Gas = sum(pHeating_Gas, na.rm = TRUE),
            pHeating_Electric = sum(pHeating_Electric, na.rm = TRUE),
            pHeating_Oil = sum(pHeating_Oil, na.rm = TRUE),
            pHeating_Solid = sum(pHeating_Solid, na.rm = TRUE),
            pHeating_Other = sum(pHeating_Other, na.rm = TRUE),
            T2S_bike = mean(T2S_bike, na.rm = TRUE),
            T2S_foot = mean(T2S_foot, na.rm = TRUE),
            T2S_car = mean(T2S_car, na.rm = TRUE),
            T2S_other = mean(T2S_other, na.rm = TRUE),
            T2S_pct = mean(T2S_pct, na.rm = TRUE),
            total_percap = mean(total_percap, na.rm = TRUE))


england <- all %>%
  group_by(country) %>%
  summarise(gas_percap_2010 = mean(gas_percap_2010, na.rm = TRUE),
            gas_percap_2011 = mean(gas_percap_2011, na.rm = TRUE),
            gas_percap_2012 = mean(gas_percap_2012, na.rm = TRUE),
            gas_percap_2013 = mean(gas_percap_2013, na.rm = TRUE),
            gas_percap_2014 = mean(gas_percap_2014, na.rm = TRUE),
            gas_percap_2015 = mean(gas_percap_2015, na.rm = TRUE),
            gas_percap_2016 = mean(gas_percap_2016, na.rm = TRUE),
            gas_percap_2017 = mean(gas_percap_2017, na.rm = TRUE),
            gas_percap_2018 = mean(gas_percap_2018, na.rm = TRUE),
            elec_percap_2010 = mean(elec_percap_2010, na.rm = TRUE),
            elec_percap_2011 = mean(elec_percap_2011, na.rm = TRUE),
            elec_percap_2012 = mean(elec_percap_2012, na.rm = TRUE),
            elec_percap_2013 = mean(elec_percap_2013, na.rm = TRUE),
            elec_percap_2014 = mean(elec_percap_2014, na.rm = TRUE),
            elec_percap_2015 = mean(elec_percap_2015, na.rm = TRUE),
            elec_percap_2016 = mean(elec_percap_2016, na.rm = TRUE),
            elec_percap_2017 = mean(elec_percap_2017, na.rm = TRUE),
            elec_percap_2018 = mean(elec_percap_2018, na.rm = TRUE),
            other_heat_percap_2011 = mean(other_heat_percap_2011, na.rm = TRUE),
            flights_percap_2018 = mean(flights_percap_2018, na.rm = TRUE),
            nutrition_kgco2e_percap = mean(nutrition_kgco2e_percap, na.rm = TRUE),
            other_shelter_kgco2e_percap = mean(other_shelter_kgco2e_percap, na.rm = TRUE),
            consumables_kgco2e_percap = mean(consumables_kgco2e_percap, na.rm = TRUE),
            recreation_kgco2e_percap = mean(recreation_kgco2e_percap, na.rm = TRUE),
            services_kgco2e_percap = mean(services_kgco2e_percap, na.rm = TRUE),
            commute_noncar_percap = mean(commute_noncar_percap, na.rm = TRUE),
            car_percap_2010 = mean(car_percap_2010, na.rm = TRUE),
            car_percap_2011 = mean(car_percap_2011, na.rm = TRUE),
            car_percap_2012 = mean(car_percap_2012, na.rm = TRUE),
            car_percap_2013 = mean(car_percap_2013, na.rm = TRUE),
            car_percap_2014 = mean(car_percap_2014, na.rm = TRUE),
            car_percap_2015 = mean(car_percap_2015, na.rm = TRUE),
            car_percap_2016 = mean(car_percap_2016, na.rm = TRUE),
            car_percap_2017 = mean(car_percap_2017, na.rm = TRUE),
            car_percap_2018 = mean(car_percap_2018, na.rm = TRUE),
            van_percap_2010 = mean(van_percap_2010, na.rm = TRUE),
            van_percap_2011 = mean(van_percap_2011, na.rm = TRUE),
            van_percap_2012 = mean(van_percap_2012, na.rm = TRUE),
            van_percap_2013 = mean(van_percap_2013, na.rm = TRUE),
            van_percap_2014 = mean(van_percap_2014, na.rm = TRUE),
            van_percap_2015 = mean(van_percap_2015, na.rm = TRUE),
            van_percap_2016 = mean(van_percap_2016, na.rm = TRUE),
            van_percap_2017 = mean(van_percap_2017, na.rm = TRUE),
            van_percap_2018 = mean(van_percap_2018, na.rm = TRUE),
            cars_percap_2010 = mean(cars_percap_2010, na.rm = TRUE),
            cars_percap_2011 = mean(cars_percap_2011, na.rm = TRUE),
            cars_percap_2012 = mean(cars_percap_2012, na.rm = TRUE),
            cars_percap_2013 = mean(cars_percap_2013, na.rm = TRUE),
            cars_percap_2014 = mean(cars_percap_2014, na.rm = TRUE),
            cars_percap_2015 = mean(cars_percap_2015, na.rm = TRUE),
            cars_percap_2016 = mean(cars_percap_2016, na.rm = TRUE),
            cars_percap_2017 = mean(cars_percap_2017, na.rm = TRUE),
            cars_percap_2018 = mean(cars_percap_2018, na.rm = TRUE),
            AvgCO2_cars_2010 = mean(AvgCO2_cars_2010, na.rm = TRUE),
            AvgCO2_cars_2011 = mean(AvgCO2_cars_2011, na.rm = TRUE),
            AvgCO2_cars_2012 = mean(AvgCO2_cars_2012, na.rm = TRUE),
            AvgCO2_cars_2013 = mean(AvgCO2_cars_2013, na.rm = TRUE),
            AvgCO2_cars_2014 = mean(AvgCO2_cars_2014, na.rm = TRUE),
            AvgCO2_cars_2015 = mean(AvgCO2_cars_2015, na.rm = TRUE),
            AvgCO2_cars_2016 = mean(AvgCO2_cars_2016, na.rm = TRUE),
            AvgCO2_cars_2017 = mean(AvgCO2_cars_2017, na.rm = TRUE),
            AvgCO2_cars_2018 = mean(AvgCO2_cars_2018, na.rm = TRUE),
            pP1900 = sum(pP1900, na.rm = TRUE),
            p1900_18 = sum(p1900_18, na.rm = TRUE),
            p1919_29 = sum(p1919_29, na.rm = TRUE),
            p1930_39 = sum(p1930_39, na.rm = TRUE),
            p1945_54 = sum(p1945_54, na.rm = TRUE),
            p1955_64 = sum(p1955_64, na.rm = TRUE),
            p1965_72 = sum(p1965_72, na.rm = TRUE),
            p1973_82 = sum(p1973_82, na.rm = TRUE),
            p1983_92 = sum(p1983_92, na.rm = TRUE),
            p1993_99 = sum(p1993_99, na.rm = TRUE),
            p2000_09 = sum(p2000_09, na.rm = TRUE),
            p2010_15 = sum(p2010_15, na.rm = TRUE),
            pUNKNOWN = sum(pUNKNOWN, na.rm = TRUE),
            Whole_House_Detached = sum(Whole_House_Detached, na.rm = TRUE),
            Whole_House_Semi = sum(Whole_House_Semi, na.rm = TRUE),
            Whole_House_Terraced = sum(Whole_House_Terraced, na.rm = TRUE),
            Flat_PurposeBuilt = sum(Flat_PurposeBuilt, na.rm = TRUE),
            Flat_Converted = sum(Flat_Converted, na.rm = TRUE),
            Flat_Commercial = sum(Flat_Commercial, na.rm = TRUE),
            Caravan = sum(Caravan, na.rm = TRUE),
            epc_total = sum(epc_total, na.rm = TRUE),
            epc_newbuild = sum(epc_newbuild, na.rm = TRUE),
            epc_A = sum(epc_A, na.rm = TRUE),
            epc_B = sum(epc_B, na.rm = TRUE),
            epc_C = sum(epc_C, na.rm = TRUE),
            epc_D = sum(epc_D, na.rm = TRUE),
            epc_E = sum(epc_E, na.rm = TRUE),
            epc_F = sum(epc_F, na.rm = TRUE),
            epc_G = sum(epc_G, na.rm = TRUE),
            epc_score_avg = mean(epc_score_avg, na.rm = TRUE),
            type_house_semi = sum(type_house_semi, na.rm = TRUE),
            type_house_midterrace = sum(type_house_midterrace, na.rm = TRUE),
            type_house_endterrace = sum(type_house_endterrace, na.rm = TRUE),
            type_house_detached = sum(type_house_detached, na.rm = TRUE),
            type_flat = sum(type_flat, na.rm = TRUE),
            type_maisonette = sum(type_maisonette, na.rm = TRUE),
            type_parkhome = sum(type_parkhome, na.rm = TRUE),
            type_other = sum(type_other, na.rm = TRUE),
            type_bungalow = sum(type_bungalow, na.rm = TRUE),
            floor_area_avg = mean(floor_area_avg, na.rm = TRUE),
            low_energy_light = mean(low_energy_light, na.rm = TRUE),
            floor_verygood = sum(floor_verygood, na.rm = TRUE),
            floor_good = sum(floor_good, na.rm = TRUE),
            floor_average = sum(floor_average, na.rm = TRUE),
            floor_poor = sum(floor_poor, na.rm = TRUE),
            floor_verypoor = sum(floor_verypoor, na.rm = TRUE),
            floor_other = sum(floor_other, na.rm = TRUE),
            window_verygood = sum(window_verygood, na.rm = TRUE),
            window_good = sum(window_good, na.rm = TRUE),
            window_average = sum(window_average, na.rm = TRUE),
            window_poor = sum(window_poor, na.rm = TRUE),
            window_verypoor = sum(window_verypoor, na.rm = TRUE),
            window_other = sum(window_other, na.rm = TRUE),
            wall_verygood = sum(wall_verygood, na.rm = TRUE),
            wall_good = sum(wall_good, na.rm = TRUE),
            wall_average = sum(wall_average, na.rm = TRUE),
            wall_poor = sum(wall_poor, na.rm = TRUE),
            wall_verypoor = sum(wall_verypoor, na.rm = TRUE),
            wall_other = sum(wall_other, na.rm = TRUE),
            roof_verygood = sum(roof_verygood, na.rm = TRUE),
            roof_good = sum(roof_good, na.rm = TRUE),
            roof_average = sum(roof_average, na.rm = TRUE),
            roof_poor = sum(roof_poor, na.rm = TRUE),
            roof_verypoor = sum(roof_verypoor, na.rm = TRUE),
            roof_other = sum(roof_other, na.rm = TRUE),
            mainheat_verygood = sum(mainheat_verygood, na.rm = TRUE),
            mainheat_good = sum(mainheat_good, na.rm = TRUE),
            mainheat_average = sum(mainheat_average, na.rm = TRUE),
            mainheat_poor = sum(mainheat_poor, na.rm = TRUE),
            mainheat_verypoor = sum(mainheat_verypoor, na.rm = TRUE),
            mainheat_other = sum(mainheat_other, na.rm = TRUE),
            mainheatcontrol_verygood = sum(mainheatcontrol_verygood, na.rm = TRUE),
            mainheatcontrol_good = sum(mainheatcontrol_good, na.rm = TRUE),
            mainheatcontrol_average = sum(mainheatcontrol_average, na.rm = TRUE),
            mainheatcontrol_poor = sum(mainheatcontrol_poor, na.rm = TRUE),
            mainheatcontrol_verypoor = sum(mainheatcontrol_verypoor, na.rm = TRUE),
            mainheatcontrol_other = sum(mainheatcontrol_other, na.rm = TRUE),
            mainheatdesc_gasboiler = sum(mainheatdesc_gasboiler, na.rm = TRUE),
            mainheatdesc_oilboiler = sum(mainheatdesc_oilboiler, na.rm = TRUE),
            mainheatdesc_storageheater = sum(mainheatdesc_storageheater, na.rm = TRUE),
            mainheatdesc_portableheater = sum(mainheatdesc_portableheater, na.rm = TRUE),
            mainheatdesc_roomheater = sum(mainheatdesc_roomheater, na.rm = TRUE),
            mainheatdesc_heatpump = sum(mainheatdesc_heatpump, na.rm = TRUE),
            mainheatdesc_community = sum(mainheatdesc_community, na.rm = TRUE),
            mainheatdesc_other = sum(mainheatdesc_other, na.rm = TRUE),
            mainfuel_mainsgas = sum(mainfuel_mainsgas, na.rm = TRUE),
            mainfuel_electric = sum(mainfuel_electric, na.rm = TRUE),
            mainfuel_oil = sum(mainfuel_oil, na.rm = TRUE),
            mainfuel_coal = sum(mainfuel_coal, na.rm = TRUE),
            mainfuel_lpg = sum(mainfuel_lpg, na.rm = TRUE),
            mainfuel_biomass = sum(mainfuel_biomass, na.rm = TRUE),
            has_solarpv = sum(has_solarpv, na.rm = TRUE),
            has_solarthermal = sum(has_solarthermal, na.rm = TRUE),
            T2W_WorkAtHome = sum(T2W_WorkAtHome, na.rm = TRUE),
            T2W_Underground = sum(T2W_Underground, na.rm = TRUE),
            T2W_Train = sum(T2W_Train, na.rm = TRUE),
            T2W_Bus = sum(T2W_Bus, na.rm = TRUE),
            T2W_Taxi = sum(T2W_Taxi, na.rm = TRUE),
            T2W_Motorcycle = sum(T2W_Motorcycle, na.rm = TRUE),
            T2W_CarOrVan = sum(T2W_CarOrVan, na.rm = TRUE),
            T2W_Passenger = sum(T2W_Passenger, na.rm = TRUE),
            T2W_Bicycle = sum(T2W_Bicycle, na.rm = TRUE),
            T2W_OnFoot = sum(T2W_OnFoot, na.rm = TRUE),
            T2W_OtherMethod = sum(T2W_OtherMethod, na.rm = TRUE),
            T2W_pct = mean(T2W_pct, na.rm = TRUE),
            km_Underground = sum(km_Underground, na.rm = TRUE),
            km_Train = sum(km_Train, na.rm = TRUE),
            km_Bus = sum(km_Bus, na.rm = TRUE),
            km_Taxi = sum(km_Taxi, na.rm = TRUE),
            km_Motorcycle = sum(km_Motorcycle, na.rm = TRUE),
            km_CarOrVan = sum(km_CarOrVan, na.rm = TRUE),
            km_Passenger = sum(km_Passenger, na.rm = TRUE),
            km_Bicycle = sum(km_Bicycle, na.rm = TRUE),
            km_OnFoot = sum(km_OnFoot, na.rm = TRUE),
            km_OtherMethod = sum(km_OtherMethod, na.rm = TRUE),
            pHeating_None = sum(pHeating_None, na.rm = TRUE),
            pHeating_Gas = sum(pHeating_Gas, na.rm = TRUE),
            pHeating_Electric = sum(pHeating_Electric, na.rm = TRUE),
            pHeating_Oil = sum(pHeating_Oil, na.rm = TRUE),
            pHeating_Solid = sum(pHeating_Solid, na.rm = TRUE),
            pHeating_Other = sum(pHeating_Other, na.rm = TRUE),
            T2S_bike = mean(T2S_bike, na.rm = TRUE),
            T2S_foot = mean(T2S_foot, na.rm = TRUE),
            T2S_car = mean(T2S_car, na.rm = TRUE),
            T2S_other = mean(T2S_other, na.rm = TRUE),
            T2S_pct = mean(T2S_pct, na.rm = TRUE),
            total_percap = mean(total_percap, na.rm = TRUE))

england$LAD17NM <- "England"
england$country <- NULL
england <- england[, names(all_la)]

all_la <- rbind(england, all_la)
all_la[2:ncol(all_la)] <- lapply(all_la[2:ncol(all_la)], round, digits = 2)


write_json(all_la, "www/data/la_averages.json")


all_class <- all %>%
  group_by(SOAC11NM) %>%
  summarise(gas_percap_2010 = mean(gas_percap_2010, na.rm = TRUE),
              gas_percap_2011 = mean(gas_percap_2011, na.rm = TRUE),
              gas_percap_2012 = mean(gas_percap_2012, na.rm = TRUE),
              gas_percap_2013 = mean(gas_percap_2013, na.rm = TRUE),
              gas_percap_2014 = mean(gas_percap_2014, na.rm = TRUE),
              gas_percap_2015 = mean(gas_percap_2015, na.rm = TRUE),
              gas_percap_2016 = mean(gas_percap_2016, na.rm = TRUE),
              gas_percap_2017 = mean(gas_percap_2017, na.rm = TRUE),
              gas_percap_2018 = mean(gas_percap_2018, na.rm = TRUE),
              elec_percap_2010 = mean(elec_percap_2010, na.rm = TRUE),
              elec_percap_2011 = mean(elec_percap_2011, na.rm = TRUE),
              elec_percap_2012 = mean(elec_percap_2012, na.rm = TRUE),
              elec_percap_2013 = mean(elec_percap_2013, na.rm = TRUE),
              elec_percap_2014 = mean(elec_percap_2014, na.rm = TRUE),
              elec_percap_2015 = mean(elec_percap_2015, na.rm = TRUE),
              elec_percap_2016 = mean(elec_percap_2016, na.rm = TRUE),
              elec_percap_2017 = mean(elec_percap_2017, na.rm = TRUE),
              elec_percap_2018 = mean(elec_percap_2018, na.rm = TRUE),
              other_heat_percap_2011 = mean(other_heat_percap_2011, na.rm = TRUE),
              flights_percap_2018 = mean(flights_percap_2018, na.rm = TRUE),
              nutrition_kgco2e_percap = mean(nutrition_kgco2e_percap, na.rm = TRUE),
              other_shelter_kgco2e_percap = mean(other_shelter_kgco2e_percap, na.rm = TRUE),
              consumables_kgco2e_percap = mean(consumables_kgco2e_percap, na.rm = TRUE),
              recreation_kgco2e_percap = mean(recreation_kgco2e_percap, na.rm = TRUE),
              services_kgco2e_percap = mean(services_kgco2e_percap, na.rm = TRUE),
              commute_noncar_percap = mean(commute_noncar_percap, na.rm = TRUE),
              car_percap_2010 = mean(car_percap_2010, na.rm = TRUE),
              car_percap_2011 = mean(car_percap_2011, na.rm = TRUE),
              car_percap_2012 = mean(car_percap_2012, na.rm = TRUE),
              car_percap_2013 = mean(car_percap_2013, na.rm = TRUE),
              car_percap_2014 = mean(car_percap_2014, na.rm = TRUE),
              car_percap_2015 = mean(car_percap_2015, na.rm = TRUE),
              car_percap_2016 = mean(car_percap_2016, na.rm = TRUE),
              car_percap_2017 = mean(car_percap_2017, na.rm = TRUE),
              car_percap_2018 = mean(car_percap_2018, na.rm = TRUE),
              van_percap_2010 = mean(van_percap_2010, na.rm = TRUE),
              van_percap_2011 = mean(van_percap_2011, na.rm = TRUE),
              van_percap_2012 = mean(van_percap_2012, na.rm = TRUE),
              van_percap_2013 = mean(van_percap_2013, na.rm = TRUE),
              van_percap_2014 = mean(van_percap_2014, na.rm = TRUE),
              van_percap_2015 = mean(van_percap_2015, na.rm = TRUE),
              van_percap_2016 = mean(van_percap_2016, na.rm = TRUE),
              van_percap_2017 = mean(van_percap_2017, na.rm = TRUE),
              van_percap_2018 = mean(van_percap_2018, na.rm = TRUE),
              cars_percap_2010 = mean(cars_percap_2010, na.rm = TRUE),
              cars_percap_2011 = mean(cars_percap_2011, na.rm = TRUE),
              cars_percap_2012 = mean(cars_percap_2012, na.rm = TRUE),
              cars_percap_2013 = mean(cars_percap_2013, na.rm = TRUE),
              cars_percap_2014 = mean(cars_percap_2014, na.rm = TRUE),
              cars_percap_2015 = mean(cars_percap_2015, na.rm = TRUE),
              cars_percap_2016 = mean(cars_percap_2016, na.rm = TRUE),
              cars_percap_2017 = mean(cars_percap_2017, na.rm = TRUE),
              cars_percap_2018 = mean(cars_percap_2018, na.rm = TRUE),
              AvgCO2_cars_2010 = mean(AvgCO2_cars_2010, na.rm = TRUE),
              AvgCO2_cars_2011 = mean(AvgCO2_cars_2011, na.rm = TRUE),
              AvgCO2_cars_2012 = mean(AvgCO2_cars_2012, na.rm = TRUE),
              AvgCO2_cars_2013 = mean(AvgCO2_cars_2013, na.rm = TRUE),
              AvgCO2_cars_2014 = mean(AvgCO2_cars_2014, na.rm = TRUE),
              AvgCO2_cars_2015 = mean(AvgCO2_cars_2015, na.rm = TRUE),
              AvgCO2_cars_2016 = mean(AvgCO2_cars_2016, na.rm = TRUE),
              AvgCO2_cars_2017 = mean(AvgCO2_cars_2017, na.rm = TRUE),
              AvgCO2_cars_2018 = mean(AvgCO2_cars_2018, na.rm = TRUE),
              total_percap = mean(total_percap, na.rm = TRUE))

all_class[2:ncol(all_class)] <- lapply(all_class[2:ncol(all_class)], round, digits = 2)

write_json(all_class, "www/data/oac_averages.json")

foo <- all_la$LAD17NM
message(paste(paste0('<option value="',foo,'">',foo,'</option>'), collapse = "\n"))
